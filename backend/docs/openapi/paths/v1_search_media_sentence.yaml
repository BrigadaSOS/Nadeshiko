post:
  tags:
    - Search
  operationId: search
  summary: Search by query
  description: |
    The primary search endpoint for finding Japanese sentences and their translations across indexed media (anime, J-Drama, audiobooks).

    This endpoint uses Elasticsearch with advanced Japanese text analysis supporting multiple input types (romaji, kanji, kana) and providing intelligent field-based boosting.

    **Query Features**
    - **Multi-language Support:** Search using Japanese (kanji/kana), Romaji, or English/Spanish
    - **Boolean Operators:** `AND`, `OR`, `NOT` supported (e.g., `(cat OR dog) AND bird`)
    - **Phrase Matching:** Use quotes for exact phrases (e.g., `"good morning"`), or pass `exact_match: true` to the request body
    - **Wildcards:** `te*t` format (leading wildcards not supported)
    - **Smart Field Selection:** Automatically chooses optimal search fields based on input type

    **Input Type Handling**
    | Input Type | Search Strategy |
    |------------|-----------------|
    | **Romaji** (`go`, `taberu`) | Boosts EN/ES translations, reading form (pronunciation), and base form |
    | **Kanji** (`食べる`, `彼女`) | Searches content and base form (dictionary form). Ignores matches by reading (homophones). |
    | **Kana** (`たべる`, `かのじょ`) | Standard search across content, base form, and reading form |
    | **English/Spanish** | Direct translation search |

    **Requirements**
    - API Key with `READ_MEDIA` permission

  requestBody:
    content:
      application/json:
        schema:
          $ref: "../components/requestBodies/SearchRequest.yaml"
  responses:
    "200":
      description: OK
      content:
        application/json:
          schema:
            $ref: "../components/responses/SearchResponse.yaml"
    "400":
      description: Bad Request
      content:
        application/json:
          schema:
            $ref: "../components/schemas/Error.yaml"
          examples:
            ValidationFailed:
              $ref: "../components/examples/ValidationFailed.yaml"
            InvalidJson:
              $ref: "../components/examples/InvalidJson.yaml"
    "401":
      $ref: "../components/responses/UnauthorizedApiKey.yaml"
    "403":
      $ref: "../components/responses/Forbidden.yaml"
    "429":
      $ref: "../components/responses/TooManyRequests.yaml"
    "500":
      $ref: "../components/responses/InternalServerError.yaml"
